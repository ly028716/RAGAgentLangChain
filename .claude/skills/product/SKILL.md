---
name: product
description: 编写和分析产品需求文档。当需要分析需求、编写PRD、定义用户故事、功能规划时使用。
allowed-tools: Read, Grep, Glob
---

# 产品/需求 Skill

为 RAGAgentLangChain 项目进行产品需求分析和文档编写。

## 核心职责

- 分析和细化产品需求
- 编写产品需求文档（PRD）
- 定义用户故事和验收标准
- 功能优先级评估
- 需求可行性分析

## 需求文档结构

### 标准 PRD 模板

```markdown
# 功能名称

## 1. 背景与目标

### 1.1 业务背景
- 为什么需要这个功能？
- 解决什么问题？
- 预期带来什么价值？

### 1.2 目标用户
- 主要用户群体
- 用户画像
- 使用场景

### 1.3 功能目标
- 核心目标（SMART原则）
- 成功指标（KPI）

## 2. 用户故事

### 2.1 主流程
**作为** [用户角色]
**我想要** [功能描述]
**以便于** [价值/目的]

**验收标准：**
- [ ] 标准1
- [ ] 标准2
- [ ] 标准3

### 2.2 异常流程
- 边界情况处理
- 错误场景处理
- 异常恢复机制

## 3. 功能描述

### 3.1 功能概述
简要描述功能的核心内容

### 3.2 详细说明
- 功能点1：详细描述
- 功能点2：详细描述
- 功能点3：详细描述

### 3.3 交互流程
1. 用户操作步骤1
2. 系统响应1
3. 用户操作步骤2
4. 系统响应2

### 3.4 界面要求
- 页面布局说明
- 关键元素位置
- 交互方式
- 响应式要求

## 4. 非功能需求

### 4.1 性能要求
- 响应时间：< X秒
- 并发用户：支持X人同时使用
- 数据量：支持X条记录

### 4.2 安全要求
- 认证要求
- 授权要求
- 数据加密
- 隐私保护

### 4.3 可用性要求
- 易用性标准
- 可访问性要求
- 多语言支持

### 4.4 兼容性要求
- 浏览器兼容性
- 设备兼容性
- 系统兼容性

## 5. 技术约束

### 5.1 技术栈限制
- 前端：Vue 3 + TypeScript
- 后端：FastAPI + Python
- AI：LangChain + 通义千问

### 5.2 依赖服务
- 依赖的内部服务
- 依赖的外部API
- 第三方库限制

### 5.3 数据约束
- 数据库表结构
- 数据格式要求
- 数据迁移需求

## 6. 依赖关系

### 6.1 前置依赖
- 需要先完成的功能
- 需要的基础设施

### 6.2 后续影响
- 对其他功能的影响
- 需要同步更新的模块

## 7. 优先级与排期

### 7.1 优先级评估
- **优先级**：P0/P1/P2/P3
- **评估方法**：MoSCoW / RICE
  - Must have（必须有）
  - Should have（应该有）
  - Could have（可以有）
  - Won't have（不会有）

### 7.2 版本规划
- 目标版本：v1.x
- MVP 范围
- 后续迭代计划

## 8. 风险与缓解

### 8.1 技术风险
| 风险 | 影响 | 概率 | 缓解措施 |
|------|------|------|----------|
| 风险1 | 高/中/低 | 高/中/低 | 具体措施 |

### 8.2 业务风险
| 风险 | 影响 | 概率 | 缓解措施 |
|------|------|------|----------|
| 风险1 | 高/中/低 | 高/中/低 | 具体措施 |

## 9. 验收标准

### 9.1 功能验收
- [ ] 功能点1完整实现
- [ ] 功能点2完整实现
- [ ] 所有用户故事通过验收

### 9.2 质量验收
- [ ] 单元测试覆盖率 > 80%
- [ ] 集成测试通过
- [ ] 性能测试达标
- [ ] 安全测试通过

### 9.3 文档验收
- [ ] API 文档完整
- [ ] 用户手册完成
- [ ] 技术文档齐全

## 10. 附录

### 10.1 参考资料
- 相关需求文档
- 竞品分析
- 用户调研报告

### 10.2 变更记录
| 日期 | 版本 | 变更内容 | 变更人 |
|------|------|----------|--------|
| YYYY-MM-DD | v1.0 | 初始版本 | XXX |
```

## 需求分析方法

### 1. 需求收集

#### 用户访谈
- 准备访谈提纲
- 记录用户痛点
- 识别核心需求

#### 竞品分析
- 功能对比
- 交互体验分析
- 差异化定位

#### 数据分析
- 用户行为数据
- 功能使用频率
- 转化漏斗分析

### 2. 需求拆解

#### 功能拆解原则
1. **独立性**：功能可独立开发和测试
2. **完整性**：功能闭环，可交付价值
3. **可测性**：有明确的验收标准
4. **合理性**：工作量适中（1-5天）

#### 拆解示例
```
大功能：智能对话系统
├── 子功能1：对话界面
│   ├── 任务1.1：消息列表展示
│   ├── 任务1.2：消息输入框
│   └── 任务1.3：流式响应展示
├── 子功能2：对话管理
│   ├── 任务2.1：创建对话
│   ├── 任务2.2：对话列表
│   └── 任务2.3：删除对话
└── 子功能3：上下文管理
    ├── 任务3.1：历史消息加载
    └── 任务3.2：上下文窗口控制
```

### 3. 优先级评估

#### MoSCoW 方法
- **Must have**：核心功能，必须实现
- **Should have**：重要功能，应该实现
- **Could have**：锦上添花，可以实现
- **Won't have**：暂不实现

#### RICE 评分法
- **Reach**（影响范围）：影响多少用户？
- **Impact**（影响程度）：对用户价值多大？（3=巨大，2=高，1=中，0.5=低，0.25=最小）
- **Confidence**（信心度）：有多确定？（100%=高，80%=中，50%=低）
- **Effort**（工作量）：需要多少人天？

**RICE 分数 = (Reach × Impact × Confidence) / Effort**

## 用户故事编写规范

### 标准格式
```
作为 [用户角色]
我想要 [功能/操作]
以便于 [业务价值/目的]

验收标准：
- [ ] Given [前置条件] When [操作] Then [预期结果]
- [ ] Given [前置条件] When [操作] Then [预期结果]
```

### 示例：文档上传功能

```markdown
## 用户故事：上传文档到知识库

**作为** 知识库管理员
**我想要** 上传多种格式的文档到知识库
**以便于** AI 可以基于这些文档回答用户问题

### 验收标准

#### 功能验收
- [ ] Given 用户已登录 When 点击"上传文档"按钮 Then 打开文件选择对话框
- [ ] Given 选择了支持的文件格式 When 点击确认 Then 开始上传并显示进度
- [ ] Given 文件上传成功 When 处理完成 Then 文档出现在知识库列表中
- [ ] Given 选择了不支持的文件格式 When 点击确认 Then 显示错误提示

#### 性能验收
- [ ] 10MB 以内的文档上传时间 < 5秒
- [ ] 支持同时上传最多 5 个文件
- [ ] 上传进度实时更新

#### 安全验收
- [ ] 文件大小限制：单个文件 < 50MB
- [ ] 文件类型白名单验证
- [ ] 文件内容安全扫描

### 边界情况
- 网络中断时的断点续传
- 重复文件名的处理
- 存储空间不足的提示
```

## 需求评审清单

### 评审前准备
- [ ] PRD 文档完整
- [ ] 用户故事清晰
- [ ] 原型图/线框图准备
- [ ] 技术可行性初步评估

### 评审要点

#### 需求完整性
- [ ] 背景和目标明确
- [ ] 用户故事完整
- [ ] 验收标准清晰
- [ ] 非功能需求齐全

#### 需求合理性
- [ ] 符合产品定位
- [ ] 用户价值明确
- [ ] 技术可行
- [ ] 资源可支持

#### 需求清晰性
- [ ] 描述无歧义
- [ ] 边界情况考虑
- [ ] 依赖关系明确
- [ ] 优先级合理

### 评审输出
- 需求确认/修改/拒绝
- 技术方案建议
- 工作量估算
- 风险识别

## 项目上下文

### 产品定位
- **产品名称**：RAG Agent 智能助手系统
- **核心价值**：基于知识库的智能问答和任务执行
- **目标用户**：企业用户、开发者、知识工作者

### 技术栈
- **前端**：Vue 3 + TypeScript + Element Plus
- **后端**：FastAPI + SQLAlchemy + LangChain
- **数据库**：MySQL + Redis + Chroma
- **AI**：通义千问 + LangChain

### 核心功能模块
1. 用户认证与授权
2. 智能对话系统
3. 知识库管理
4. Agent 工具调用
5. 对话历史管理

## 协作接口

### 输入来源
- 用户反馈和需求
- 业务目标和战略
- 市场调研和竞品分析

### 输出交付
- **给架构 Agent**：需求规格说明、功能边界定义
- **给 UI Agent**：交互需求、用户流程、页面结构
- **给测试 Agent**：验收标准、测试场景、边界情况
- **给开发 Agent**：功能描述、业务规则、数据要求

## 常见问题

### Q1: 如何判断需求是否合理？
**A**: 使用 SMART 原则评估：
- **S**pecific（具体的）：需求描述清晰具体
- **M**easurable（可衡量的）：有明确的成功指标
- **A**chievable（可实现的）：技术和资源可支持
- **R**elevant（相关的）：符合产品目标
- **T**ime-bound（有时限的）：有明确的交付时间

### Q2: 如何处理需求变更？
**A**: 需求变更流程：
1. 评估变更影响（范围、时间、资源）
2. 更新 PRD 文档和变更记录
3. 同步相关团队（开发、测试、UI）
4. 调整优先级和排期
5. 重新评审和确认

### Q3: 如何平衡功能完整性和开发效率？
**A**: MVP（最小可行产品）策略：
1. 识别核心价值功能（Must have）
2. 先实现 MVP，快速验证
3. 根据反馈迭代优化
4. 逐步添加增强功能

## 最佳实践

1. **用户视角**：始终从用户角度思考需求
2. **数据驱动**：用数据支撑需求决策
3. **迭代思维**：小步快跑，快速验证
4. **协作沟通**：及时同步，减少理解偏差
5. **文档规范**：保持文档更新和可追溯性
